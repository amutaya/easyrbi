---
output: github_document
---


```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

### easyrbi R Package

<!-- badges: start -->
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://lifecycle.r-lib.org/articles/stages.html#experimental)
[![CRAN status](https://www.r-pkg.org/badges/version/SDS270)](https://CRAN.R-project.org/package=SDS270)
[![R-CMD-check](https://github.com/wndlovu/easyrbi/workflows/R-CMD-check/badge.svg)](https://github.com/wndlovu/easyrbi/actions)
<!-- badges: end -->


## Overview

The [`easyrbi`](https://github.com/amutaya/easyrbi) R package consists of functions that retrieve streamflow data from the USGS website, by using tools in `dataRetrieval` package and calculate the Richards-Baker Flashiness Index (RBI) trends over time for any given gauge stations. The package also contains functions to download time series land use data (USGS Gages II) collected between 1931-01-01 and 2014-12-31. Some of the functions included in the package:

- `sitedata`: retrieves hydrology data for given USGS gauge sites for a specified period.
- `rbi_df`: returns calculated RBI values for given USGS sites for a specified period.
- `trends`: returns a data frame containing Mann-Kendall and sens.slope summary statistics for a custom number of sites specified by the user.
- `basin_id`: Check the drainage area, eco-region and classification (reference or non-reference)
- `dam_removal`: retrieves dam removal data from the USGS Gages II website for any number of given gauge station numbers.


## Installation

You can install the development version of easyrbi from Github:
```{r, eval=FALSE, message=FALSE}
# If you haven't installed remotes yet, do so:
# install.packages("remotes")
remotes::install_github("amutaya/easyrbi")
```

## Examples

```{r example, message=FALSE}
library(easyrbi)
library(tidyverse)
library(trend)
library(Kendall)
library(dataRetrieval)
library(usethis)
```

#### Retrieve USGS gauge station data 
- Returns a data.frames with 18 variables from the USGS database which include discharge, drainage area and the waterYear.
```{r, eval = TRUE}
sitedata(c("01564500", "01567000"), "1970-10-01", "1980-09-30") %>% 
  head(10)
```

#### Calculate the annul Richard's Barker Index (RBI) 
- Returns a data.frames with the waterYear and respective RBI values for given sites over a specified timeframe
```{r, eval = TRUE}
rbi_df(c("01564500", "01567000"), "1970-10-01", "1980-09-30")
```
#### Test time series trends
- Returns the Mann-Kendall and sens.slope summary statistics for any given USGS gauge sites. 
```{r, eval=TRUE}
data <- rbi_df(c("01564500", "01567000"), "1970-10-01", "1980-09-30")

trends(x = data) 
```
#### Get basin ID data 
```{r, eval=TRUE, warning=FALSE, message=FALSE}
basin_id(c("01567000", "01490000", "01492500"))
```
#### Retrieve land use data
- Retrieves dam removal data for specified sites directly from the USGS Gages II website. This time series data recorded between 1931-01-01 and 2014-12-31.
```{r, eval=TRUE, warning=FALSE, message=FALSE}
dam_removal(c("01564500", "01567000"))
```
#### Investigate the trends at sites where dams were removed.
- For any given gauge stations, check if there is a relationship between trends and dam removals 
```{r, eval=TRUE, warning=FALSE, message=FALSE}
dam_trends(c("01092000", "01100000", "01208500"), "1970-10-01", "1990-09-30")
```

